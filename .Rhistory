Pok_Log.Linear <- lm(log(PhyscialActivity) ~ log(education) +
log(Gender) + log(StepsAttitude) +
log(PokemonGo_AppUsage) +
log(PokemonRelate_Behaviour), data = Pok_Grouped)
# Model observation
summary(Pok_Log.Linear)
Pok.Linear <- lm(PhyscialActivity ~ age + education +
Gender + Attitude + StepsAttitude +
PokemonGo_AppUsage + social_sharing +
PokemonRelate_Behaviour, data = Pok_Grouped)
summary(Pok.Linear)
Pok.Linear <- lm(PhyscialActivity ~ age + education +
Gender + Attitude + StepsAttitude +
PokemonGo_AppUsage +
PokemonRelate_Behaviour, data = Pok_Grouped)
summary(Pok.Linear)
library(caret)
library(randomForest)
Pok.Linear <- randomForest(PhyscialActivity ~ age + education +
Gender + Attitude + StepsAttitude +
PokemonGo_AppUsage +
PokemonRelate_Behaviour, data = Pok_Grouped)
confusionMatrix(Pok.Linear)
Pok.RF <- randomForest(PhyscialActivity ~ age + education +
Gender + Attitude + StepsAttitude +
PokemonGo_AppUsage +
PokemonRelate_Behaviour, data = Pok_Grouped)
confusionMatrix(Pok_Grouped$PhyscialActivity, predict(Pok.RF))
mean(Pok_Grouped$PhyscialActivity == predict(Pok.RF))
Pok.RF
library(e1071)
Pok.svm <- svm(PhyscialActivity ~ ., data = Pok_Grouped, kernel = "linear",
cost = 10, scale = FALSE)
print(Pok.svm)
summary(Pok.svm)
tune.out = tune(svm ,y~.,data=dat ,kernel ="linear",
ranges =list(cost=c(0.001,0.01,0.1, 1,5,10,100)))
tune.out = tune(svm , PhyscialActivity~., data=Pok_Grouped ,kernel ="linear",
ranges =list(cost=c(0.001,0.01,0.1, 1,5,10,100)))
summary(tune.out)
bestmod =tune.out$best.model
bestmod
########################
###Model Constructing###
########################
install.packages("lavaan", dependencies=TRUE)
library(lavaan)
###gam###
library(gam)
###gam###
library(gam)
install.packages("gam")
###gam###
library(gam)
amgam <- gam(PhyscialActivity ~ lo(age) + lo(education) +
lo(Gender) + lo(Attitude) + lo(StepsAttitude) +
lo(PokemonGo_AppUsage) + lo(social_sharing) +
lo(PokemonRelate_Behaviour),
data=Pok_Grouped)
# import library required
library(dplyr)
library(psych)
####################################
###Data Observation and Cleansing###
####################################
# loading dataset
load("pokemon.Rdata")
# observe data
head(pok,3)
# primary observe of data
summary(pok)
# checking number of missing value
sum(is.na(pok))
# checking unreasonable items in age
pok_age_s0 <- pok[pok$age <0,]
pok_age_s0
#@ This dataset is really good, without error or missing value
# However, according to the article, the records where the answer of
# ATTENTION_filter1 is not "Disagree" should be filtered
pok_new <- pok[pok$ATTENTION_filter1=="Disagree",]
pok_new$ATTENTION_filter1 <- NULL
summary(pok_new)
#################################
###Preparation of Grouped data###
#################################
###convert variables into numeric values###
pok_new[,4:30] <- pok_new[,4:30] %>% mutate_if(is.factor,as.numeric)
summary(pok_new)
###Justify the grouping###
# Calculate Cronbach's Alpha
# Attitude
alpha(pok_new[7:12], check.keys=TRUE)
# steps Attitude
alpha(pok_new[13:18], check.keys=TRUE)
# Behaviour
alpha(pok_new[19:24], check.keys=TRUE)
# Pokemon Behviour
alpha(pok_new[27:29], check.keys=TRUE)
#@ Since alpha of behaviour and Pokemon behaviour are "Acceptable"
#@ we group them together
# variable grouping
Attitude <- rowMeans(pok_new[7:12])
StepAttitude <- rowMeans(pok_new[13:18])
Behqviour <- rowMeans(pok_new[19:24])
PokemonBehaviour <- rowMeans(pok_new[27:29])
# create new dataset
Pok_Grouped <- pok_new[c(4:6)]
Pok_Grouped$Attitude <- Attitude
Pok_Grouped$StepsAttitude <- StepAttitude
Pok_Grouped$PhyscialActivity <- Behaviour
Pok_Grouped$PokemonGo_AppUsage <- pok_new$app_usage_PokemonGoApp_pokemonusage1
Pok_Grouped$social_sharing <- pok_new$social_sharing
Pok_Grouped$PokemonRelate_Behaviour <- PokemonBehaviour
head(Pok_Grouped)
summary(Pok_Grouped)
# libraries required
library(ggplot2)
library(GGally)
require(foreign)
require(MASS)
require(Hmisc)
require(reshape2)
# Start plotting
ggpairs(Pok_Grouped)
boxplot(PhyscialActivity~education,
data=Pok_Grouped,
main="Different boxplots for gender",
xlab="Month Number",
ylab="Amount of Physical Activity"
)
boxplot(PhyscialActivity~Gender,
data=Pok_Grouped,
main="Different boxplots for Education Level",
xlab="Education Level",
ylab="Amount of Physical Activity"
)
###linear model###
# full model construction
#Pok_Log.Linear <- lm(log(PhyscialActivity) ~ log(age) + log(education) +
#                             log(Gender) + log(Attitude) + log(StepsAttitude) +
#                             log(PokemonGo_AppUsage) + log(social_sharing) +
#                             log(PokemonRelate_Behaviour), data = Pok_Grouped)
Pok.Linear <- glm(PhyscialActivity ~ ., data = Pok_Grouped)
summary(Pok.Linear)
Pok.Linear <- glm(PhyscialActivity ~ ., data = Pok_Grouped, family=binomial)
Pok.Linear <- glm(PhyscialActivity ~ ., data = Pok_Grouped, family=poisson)
summary(Pok.Poisson)
###linear model###
# full model construction
#Pok_Log.Linear <- lm(log(PhyscialActivity) ~ log(age) + log(education) +
#                             log(Gender) + log(Attitude) + log(StepsAttitude) +
#                             log(PokemonGo_AppUsage) + log(social_sharing) +
#                             log(PokemonRelate_Behaviour), data = Pok_Grouped)
Pok.Linear <- glm(PhyscialActivity ~ ., data = Pok_Grouped)
summary(Pok.Linear)
Pok.Poisson <- glm(PhyscialActivity ~ ., data = Pok_Grouped, family=poisson)
summary(Pok.Poisson)
View(pok)
View(pok)
View(Pok_Grouped)
View(Pok_Grouped)
summary(Pok_Grouped)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
# import library required
library(dplyr)
library(psych)
# loading dataset
load("pokemon.Rdata")
# observe data
head(pok,3)
# primary observe of data
summary(pok)
# checking number of missing value
sum(is.na(pok))
# checking unreasonable items in age
pok_age_s0 <- pok[pok$age <0,]
pok_age_s0
# However, according to the article, the records where the answer of
# ATTENTION_filter1 is not "Disagree" should be filtered
pok_new <- pok[pok$ATTENTION_filter1=="Disagree",]
pok_new$ATTENTION_filter1 <- NULL
summary(pok_new)
pairs(pok_new)
# primary observe of data
summary(pok)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(psych)
load("pokemon.Rdata")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(psych)
load("pokemon.Rdata")
sum(is.na(pok))
# primary observe of data
summary(pok)
# import library required
library(dplyr)
library(psych)
####################################
###Data Observation and Cleansing###
####################################
# loading dataset
load("pokemon.Rdata")
# observe data
head(pok,3)
# primary observe of data
summary(pok)
# checking number of missing value
sum(is.na(pok))
# checking unreasonable items in age
pok_age_s0 <- pok[pok$age <0,]
pok_age_s0
#@ This dataset is really good, without error or missing value
# However, according to the article, the records where the answer of
# ATTENTION_filter1 is not "Disagree" should be filtered
pok_new <- pok[pok$ATTENTION_filter1=="Disagree",]
pok_new$ATTENTION_filter1 <- NULL
summary(pok_new)
pairs(pok_new)
#################################
###Preparation of Grouped data###
#################################
###convert variables into numeric values###
pok_new[,4:30] <- pok_new[,4:30] %>% mutate_if(is.factor,as.numeric)
summary(pok_new)
###Justify the grouping###
# Calculate Cronbach's Alpha
# Attitude
alpha(pok_new[7:12], check.keys=TRUE)
# steps Attitude
alpha(pok_new[13:18], check.keys=TRUE)
# Behaviour
alpha(pok_new[19:24], check.keys=TRUE)
# Pokemon Behviour
alpha(pok_new[27:29], check.keys=TRUE)
#@ Since alpha of behaviour and Pokemon behaviour are "Acceptable"
#@ we group them together
# variable grouping
Attitude <- rowMeans(pok_new[7:12])
StepAttitude <- rowMeans(pok_new[13:18])
Behqviour <- rowMeans(pok_new[19:24])
PokemonBehaviour <- rowMeans(pok_new[27:29])
# create new dataset
Pok_Grouped <- pok_new[c(4:6)]
Pok_Grouped$Attitude <- Attitude
Pok_Grouped$StepsAttitude <- StepAttitude
Pok_Grouped$PhyscialActivity <- Behaviour
Pok_Grouped$PokemonGo_AppUsage <- pok_new$app_usage_PokemonGoApp_pokemonusage1
Pok_Grouped$social_sharing <- pok_new$social_sharing
Pok_Grouped$PokemonRelate_Behaviour <- PokemonBehaviour
head(Pok_Grouped)
summary(Pok_Grouped)
########################
###Data Visualisation###
########################
# libraries required
library(ggplot2)
library(GGally)
require(foreign)
require(MASS)
require(Hmisc)
require(reshape2)
# Start plotting
ggpairs(Pok_Grouped)
boxplot(PhyscialActivity~education,
data=Pok_Grouped,
main="Different boxplots for gender",
xlab="Month Number",
ylab="Amount of Physical Activity"
)
boxplot(PhyscialActivity~Gender,
data=Pok_Grouped,
main="Different boxplots for Education Level",
xlab="Education Level",
ylab="Amount of Physical Activity"
)
dev.off()
par(mfrow = c(3, 1))
ggplot(Pok_Grouped, aes(x = social_sharing, y = PhyscialActivity)) +
geom_point() +
labs(x = "Social Sharing", y = "Amount of Physcial Activity") +
geom_smooth(method = "lm", se = F)
ggplot(Pok_Grouped, aes(x = PokemonGo_AppUsage, y = PhyscialActivity)) +
geom_point() +
labs(x = "PokemonGo_AppUsage", y = "Amount of Physcial Activity") +
geom_smooth(method = "lm", se = F)
ggplot(Pok_Grouped, aes(x = social_sharing, y = PokemonGo_AppUsage)) +
geom_point() +
labs(x = "Social Sharing", y = "PokemonGo_AppUsage") +
geom_smooth(method = "lm", se = F)
dev.off()
###linear model###
# full model construction
#Pok_Log.Linear <- lm(log(PhyscialActivity) ~ log(age) + log(education) +
#                             log(Gender) + log(Attitude) + log(StepsAttitude) +
#                             log(PokemonGo_AppUsage) + log(social_sharing) +
#                             log(PokemonRelate_Behaviour), data = Pok_Grouped)
Pok.Linear <- glm(log(PhyscialActivity) ~ ., data = Pok_Grouped)
summary(Pok.Linear)
###linear model###
# full model construction
Pok_Log.Linear <- lm(log(PhyscialActivity) ~ ., data = Pok_Grouped)
summary(Pok_Log.Linear)
library(olsrr)
#assumption checking
par(mfrow = c(2, 2))
plot(Pok_Log.Linear)
dev.off()
ols_step_best_subset(Pok_Log.Linear)
a <- ols_step_best_subset(Pok_Log.Linear)
plot(a)
###linear model###
# full model construction
Pok.model <- lm(log(PhyscialActivity) ~ ., data = Pok_Grouped)
b <- stepAIC(Pok.model)
plot(a)
plot(b)
par(mfrow = c(2, 2))
plot(b)
###linear model###
# full model construction
Pok.model <- lm(log10(PhyscialActivity) ~ ., data = Pok_Grouped)
#Pok.Linear <- glm(log(PhyscialActivity) ~ ., data = Pok_Grouped)
summary(Pok.model)
#assumption checking
par(mfrow = c(2, 2))
plot(Pok.model)
dev.off()
b <- stepAIC(Pok.model)
par(mfrow = c(2, 2))
plot(b)
dev.off()
###linear model###
# full model construction
Pok.model <- lm(log10(PhyscialActivity) ~ ., data = Pok_Grouped)
#Pok.Linear <- glm(log(PhyscialActivity) ~ ., data = Pok_Grouped)
summary(Pok.model)
#assumption checking
par(mfrow = c(2, 2))
plot(Pok.model)
dev.off()
a <- ols_step_best_subset(Pok.model)
par(mfrow = c(2, 2))
plot(b)
###linear model###
# full model construction
Pok.model <- lm(PhyscialActivity ~ ., data = Pok_Grouped)
#Pok.Linear <- glm(log(PhyscialActivity) ~ ., data = Pok_Grouped)
summary(Pok.model)
###linear model###
# full model construction
Pok.model <- lm(PhyscialActivity ~ ., data = Pok_Grouped)
###linear model###
# full model construction
Pok.model <- lm(PhyscialActivity ~ ., data = Pok_Grouped)
#Pok.Linear <- glm(log(PhyscialActivity) ~ ., data = Pok_Grouped)
summary(Pok.model)
library(olsrr)
#assumption checking
par(mfrow = c(2, 2))
plot(Pok.model)
par(mfrow = c(3, 1))
# Start plotting
ggpairs(Pok_Grouped)
###linear model###
# full model construction
Pok.model <- lm(PhyscialActivity ~ age*education, data = Pok_Grouped)
###linear model###
# full model construction
Pok.model <- lm(PhyscialActivity ~ age*education*Gender*Attitude*StepsAttitude*
PokemonGo_AppUsage*social_sharing*PokemonRelate_Behaviour, data = Pok_Grouped)
#Pok.Linear <- glm(log(PhyscialActivity) ~ ., data = Pok_Grouped)
summary(Pok.model)
#assumption checking
par(mfrow = c(2, 2))
plot(Pok.model)
dev.off()
# a <- ols_step_best_subset(Pok.model)
final.model <- stepAIC(Pok.model)
par(mfrow = c(2, 2))
plot(b)
summary(final.model)
# Start plotting
ggpairs(Pok_Grouped)
###linear model###
# full model construction
Pok.model <- lm(PhyscialActivity ~ age + education + Gender + Attitude +
StepsAttitude + PokemonGo_AppUsage*PokemonRelate_Behaviour +
social_sharing, data = Pok_Grouped)
#Pok.Linear <- glm(log(PhyscialActivity) ~ ., data = Pok_Grouped)
summary(Pok.model)
library(olsrr)
#assumption checking
par(mfrow = c(2, 2))
plot(Pok.model)
# a <- ols_step_best_subset(Pok.model)
final.model <- stepAIC(Pok.model)
summary(final.model)
par(mfrow = c(2, 2))
plot(b)
###linear model###
# full model construction
library(corpcor)
# Start plotting
ggpairs(Pok_Grouped)
car::vif(Pok.model)
Pok.model <- lm(PhyscialActivity ~ age + education + Gender + Attitude +
StepsAttitude + PokemonGo_AppUsage + PokemonRelate_Behaviour +
social_sharing, data = Pok_Grouped)
#Pok.Linear <- glm(log(PhyscialActivity) ~ ., data = Pok_Grouped)
summary(Pok.model)
car::vif(Pok.model)
Pok.model <- lm(PhyscialActivity ~ age + education + Gender + Attitude +
StepsAttitude + PokemonGo_AppUsage + PokemonRelate_Behaviour +
social_sharing, data = Pok_Grouped)
#Pok.Linear <- glm(log(PhyscialActivity) ~ ., data = Pok_Grouped)
summary(Pok.model)
car::vif(Pok.model)
a <- ols_step_best_subset(Pok.model)
final_ols <- ols_step_best_subset(Pok.model)
summary(final_ols)
final_ols
final.model <- stepAIC(Pok.model)
plot(final.model )
# response variable
logR.model <- lm(log(PhyscialActivity) ~ age + education + Gender + Attitude +
StepsAttitude + PokemonGo_AppUsage + PokemonRelate_Behaviour +
social_sharing, data = Pok_Grouped)
# response variable
logR.model <- lm(log(PhyscialActivity) ~ age + education + Gender + Attitude +
StepsAttitude + PokemonGo_AppUsage + PokemonRelate_Behaviour +
social_sharing, data = Pok_Grouped)
final_ols <- ols_step_best_subset(logR.model)
final_ols
final.model <- stepAIC(logR.model)
summary(final.model)
par(mfrow = c(2, 2))
plot(final.model )
summary(final.model)
# response variable
logR.model <- lm(PhyscialActivity ~ log(age) + log(education) + log(Gender) + log(Attitude) +
log(StepsAttitude) + log(PokemonGo_AppUsage) + log(PokemonRelate_Behaviour) +
log(social_sharing), data = Pok_Grouped)
final_ols <- ols_step_best_subset(logR.model)
final_ols
final.model <- stepAIC(logR.model)
summary(final.model)
par(mfrow = c(2, 2))
plot(final.model )
# response variable
logR.model <- lm(log(PhyscialActivity) ~ log(age) + log(education) + log(Gender) + log(Attitude) +
log(StepsAttitude) + log(PokemonGo_AppUsage) + log(PokemonRelate_Behaviour) +
log(social_sharing), data = Pok_Grouped)
final_ols <- ols_step_best_subset(logR.model)
final_ols
final.model <- stepAIC(logR.model)
summary(final.model)
par(mfrow = c(2, 2))
plot(final.model )
# response variable
logR.model <- lm(log(PhyscialActivity) ~ log(age) + log(education) + log(Gender) + log(Attitude) +
log(StepsAttitude) + log(PokemonGo_AppUsage) + log(PokemonRelate_Behaviour) +
log(social_sharing), data = Pok_Grouped)
final_ols <- ols_step_best_subset(logR.model)
final_ols
final.model <- stepAIC(logR.model)
summary(final.model)
par(mfrow = c(2, 2))
plot(final.model )
# response variable
logR.model <- lm(log10(PhyscialActivity) ~ ., data = Pok_Grouped)
final_ols <- ols_step_best_subset(logR.model)
final_ols
final.model <- stepAIC(logR.model)
summary(final.model)
final_ols <- ols_step_best_subset(logR.model)
final_ols
# response variable
logR.model <- lm(log10(PhyscialActivity) ~ ., data = Pok_Grouped)
final_ols <- ols_step_best_subset(logR.model)
final_ols
final.model <- stepAIC(logR.model)
summary(final.model)
par(mfrow = c(2, 2))
plot(final.model )
# response variable
logR.model <- lm(PhyscialActivity ~ log10(age) + log10(education) + log10(Gender) +
log10(Attitude) + log10(StepsAttitude) +
log10(PokemonGo_AppUsage) + log10(PokemonRelate_Behaviour) +
log10(social_sharing), data = Pok_Grouped)
final_ols <- ols_step_best_subset(logR.model)
final_ols
final.model <- stepAIC(logR.model)
summary(final.model)
par(mfrow = c(2, 2))
plot(final.model )
# response variable
logR.model <- lm(log(PhyscialActivity) ~ log10(age) + log10(education) + log10(Gender) +
log10(Attitude) + log10(StepsAttitude) +
log10(PokemonGo_AppUsage) + log10(PokemonRelate_Behaviour) +
log10(social_sharing), data = Pok_Grouped)
final_ols <- ols_step_best_subset(logR.model)
final_ols
final.model <- stepAIC(logR.model)
summary(final.model)
par(mfrow = c(2, 2))
plot(final.model )
