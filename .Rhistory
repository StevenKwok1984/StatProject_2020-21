load("pokemon.Rdata")
head(pok,1)
# primary observe of data
summary(pok)
# checking unreasonable items in age
pok_age_s0 <- pok[pok$age <0,]
pok_age_s0
pok_age_l100 <- pok[pok$age >100,]
pok_age_l100
# However, according to the article, the records where the answer of
# ATTENTION_filter1 is not "Disagree" should be filtered
pok_new <- pok[pok$ATTENTION_filter1=="Disagree",]
pok_new$ATTENTION_filter1 <- NULL
summary(pok_new)
###convert variables into numeric values###
pok_new[,4:30] <- pok_new[,4:30] %>% mutate_if(is.factor,as.numeric)
summary(pok_new)
# Calculate Cronbach's Alpha
# Attitude
alpha(pok_new[7:12], check.keys=TRUE)
# steps Attitude
alpha(pok_new[13:18], check.keys=TRUE)
# Behaviour
alpha(pok_new[19:24], check.keys=TRUE)
# Pokemon Behviour
alpha(pok_new[27:29], check.keys=TRUE)
# variable grouping
Attitude <- rowMeans(pok_new[7:12])
StepAttitude <- rowMeans(pok_new[13:18])
Behqviour <- rowMeans(pok_new[19:24])
PokemonBehaviour <- rowMeans(pok_new[27:29])
# create new dataset
Pok_Grouped <- pok_new[c(4:6)]
Pok_Grouped$Attitude <- Attitude
Pok_Grouped$StepsAttitude <- StepAttitude
Pok_Grouped$PhyscialActivity <- Behaviour
Pok_Grouped$PokemonGo_AppUsage <- pok_new$app_usage_PokemonGoApp_pokemonusage1
Pok_Grouped$social_sharing <- pok_new$social_sharing
Pok_Grouped$PokemonRelate_Behaviour <- PokemonBehaviour
head(Pok_Grouped)
###Simple linear model###
# Relations between all variables and Physical Acticity
Pok_Linear <- lm(PhyscialActivity ~ . , data = Pok_Grouped)
##Stepwise Selection
step.Pok_Linear <- stepAIC(Pok_Linear, direction = "both",
trace = FALSE)
summary(step.model)
summary(step.Pok_Linear)
##Stepwise Selection
step.Pok_Linear <- stepAIC(Pok_Linear, direction = "both",
trace = TRUE)
summary(step.Pok_Linear)
#@ Since t-value "Gender", "StepsAttitude" and "PokemonRelate_Behaviour"
#@ smaller than 0.001, drop them
# The Final model
Pok_Linear_final <- lm(PhyscialActivity ~ age + education + Attitude, data = Pok_Grouped)
##Stepwise Selection
AIC.step.Pok_Linear <- stepAIC(Pok_Linear, direction = "both",
trace = TRUE)
##Stepwise Selection
AIC.step.Pok_Linear <- stepAIC(Pok_Linear, direction = "both",
trace = FALSE)
summary(AIC.step.Pok_Linear)
BIC.step.Pok_Linear <- stepBIC(Pok_Linear, direction = "both",
trace = FALSE)
summary(BIC.step.Pok_Linear)
ggplot(Pok_Grouped, aes(age, PhyscialActivity)) +
geom_jitter(height = 0) +
ggtitle("Age versus Physical ACtivity")
ggplot(Pok_Grouped, aes(age, PhyscialActivity)) +
ggtitle("Age versus Physical ACtivity")
ggplot(Pok_Grouped, aes(Attitude, PhyscialActivity)) +
ggtitle("Age versus Physical ACtivity")
ggplot(Pok_Grouped, aes(Attitude, PhyscialActivity)) +
geom_jitter(height = 0) +
ggtitle("Attitude versus Physical Activity")
ggplot(Pok_Grouped, aes(PokemonGo_AppUsage, PhyscialActivity)) +
geom_jitter(height = 0) +
ggtitle("Attitude versus Physical Activity")
ggplot(Pok_Grouped, aes(Attitude, PhyscialActivity)) +
geom_jitter(height = 0) +
ggtitle("Attitude versus Physical Activity")
library(dplyr)
library(psych)
require(foreign)
require(ggplot2)
require(MASS)
require(Hmisc)
require(reshape2)
####################################
###Data Observation and Cleansing###
####################################
# The first observation
load("pokemon.Rdata")
head(pok,1)
# primary observe of data
summary(pok)
# checking unreasonable items in age
pok_age_s0 <- pok[pok$age <0,]
pok_age_s0
pok_age_l100 <- pok[pok$age >100,]
pok_age_l100
#@ This dataset is really good, without error or missing value
# However, according to the article, the records where the answer of
# ATTENTION_filter1 is not "Disagree" should be filtered
pok_new <- pok[pok$ATTENTION_filter1=="Disagree",]
pok_new$ATTENTION_filter1 <- NULL
summary(pok_new)
#################################
###Preparation of Grouped data###
#################################
###convert variables into numeric values###
pok_new[,4:30] <- pok_new[,4:30] %>% mutate_if(is.factor,as.numeric)
summary(pok_new)
###Justify the grouping###
# Calculate Cronbach's Alpha
# Attitude
alpha(pok_new[7:12], check.keys=TRUE)
# steps Attitude
alpha(pok_new[13:18], check.keys=TRUE)
# Behaviour
alpha(pok_new[19:24], check.keys=TRUE)
# Pokemon Behviour
alpha(pok_new[27:29], check.keys=TRUE)
#@ Since alpha of behaviour and Pokemon behaviour are "Acceptable"
#@ we group them together
# variable grouping
Attitude <- rowMeans(pok_new[7:12])
StepAttitude <- rowMeans(pok_new[13:18])
Behqviour <- rowMeans(pok_new[19:24])
PokemonBehaviour <- rowMeans(pok_new[27:29])
# create new dataset
Pok_Grouped <- pok_new[c(4:6)]
Pok_Grouped$Attitude <- Attitude
Pok_Grouped$StepsAttitude <- StepAttitude
Pok_Grouped$PhyscialActivity <- Behaviour
Pok_Grouped$PokemonGo_AppUsage <- pok_new$app_usage_PokemonGoApp_pokemonusage1
Pok_Grouped$social_sharing <- pok_new$social_sharing
Pok_Grouped$PokemonRelate_Behaviour <- PokemonBehaviour
head(Pok_Grouped)
Pok_Grouped$PokemonGo_AppUsage
ggplot(Pok_Grouped, aes(Attitude, PhyscialActivity)) +
geom_jitter(height = 0) +
ggtitle("Attitude versus Physical Activity")
ggplot(Pok_Grouped, aes(Attitude, PhyscialActivity)) +
ggtitle("Attitude versus Physical Activity")
summary(Pok_Grouped)
ggplot(Pok_Grouped, aes(Attitude, PhyscialActivity)) +
geom_point() +
ggtitle("Attitude versus Physical Activity")
##Stepwise Selection
stepwise.Pok_Linear <- stepAIC(Pok_Linear, direction = "both",
trace = FALSE)
summary(stepwise.Pok_Linear)
summary(stepwise.Pok_Linear)
##Stepwise Selection
stepwise.Pok_Linear <- stepAIC(Pok_Linear, direction = "both",
trace = FALSE)
summary(stepwise.Pok_Linear)
stepwise.Pok_Linear
stepAIC(Pok_Linear, direction = "both",
trace = FALSE)
stepAIC(Pok_Linear, direction = "both",
trace = TRUE)
###logistic regression model###
Pok_Logit <- polr(PhyscialActivity ~ . , data = Pok_Grouped, Hess = TRUE)
ggplot(Pok_Grouped, aes(Attitude, PhyscialActivity), color=gender) +
geom_point() +
ggtitle("Attitude versus Physical Activity")
ggplot(Pok_Grouped, aes(Attitude, PhyscialActivity, color=Gender)) +
geom_point() +
ggtitle("Attitude versus Physical Activity")
ggplot(Pok_Grouped, aes(StepsAttitude, PhyscialActivity, color=Gender)) +
geom_point() +
ggtitle("Attitude versus Physical Activity, colored by gender")
ggplot(Pok_Grouped, aes(PokemonGo_AppUsage, PhyscialActivity, color=Gender)) +
geom_point() +
ggtitle("Attitude versus Physical Activity, colored by gender")
ggplot(Pok_Grouped, aes(PokemonRelate_Behaviour, PhyscialActivity, color=Gender)) +
geom_point() +
ggtitle("Attitude versus Physical Activity, colored by gender")
ggplot(Pok_Grouped, aes(Gender, PhyscialActivity)) +
geom_point() +
ggtitle("Attitude versus Physical Activity, colored by gender")
boxplot(PhyscialActivity~Gender,
data=airquality,
main="Different boxplots for each month",
xlab="Month Number",
ylab="Amount of Physical Activity"
)
boxplot(PhyscialActivity~Gender,
data=Pok_Grouped,
main="Different boxplots for gender",
xlab="Month Number",
ylab="Amount of Physical Activity"
)
boxplot(PhyscialActivity~education,
data=Pok_Grouped,
main="Different boxplots for gender",
xlab="Month Number",
ylab="Amount of Physical Activity"
)
stepwise.Pok_Linear
#@ According the AIC criteria, stewise.Pok_Linear model is the best model with
#@ smallest AIC. However, "StepsAttutide" and "Attitude" having the same aspects,
#@ Thus, we should drop one. According to the result, Drop of "Attitude" only cause
#@ small rise, so we drop "Attitude"
Pok_Linear_final <- stepwise.Pok_Linear %>% subset(select = -c(StepsAttitude))
#@ According the AIC criteria, stewise.Pok_Linear model is the best model with
#@ smallest AIC. However, "StepsAttutide" and "Attitude" having the same aspects,
#@ Thus, we should drop one. According to the result, Drop of "Attitude" only cause
#@ small rise, so we drop "Attitude"
Pok_Linear_final <- stepwise.Pok_Linear
stepwise.Pok_Linear
#@ According the AIC criteria, stewise.Pok_Linear model is the best model with
#@ smallest AIC. However, "StepsAttutide" and "Attitude" having the same aspects,
#@ Thus, we should drop one. According to the result, Drop of "Attitude" only cause
#@ small rise, so we drop "Attitude"
Pok_Linear_final <- lm(PhyscialActivity ~ age + education + StepsAttitude +
PokemonGo_AppUsage + PokemonRelate_Behaviour,
data = Pok_Grouped)
summary(Pok_Linear_final)
# import library required
library(dplyr)
library(psych)
require(foreign)
library(ggplot2)
require(MASS)
require(Hmisc)
require(reshape2)
library(GGally)
ggpairs(Pok_Grouped)
Pok.Grouped_New <- Pok_Grouped
Pok.Grouped_New$Attitude <- NULL
Pok.Grouped_New$social_sharing <- NULL
ggpairs(Pok.Grouped_New)
summary(Pok_Linear_final)
ggpairs(Pok_Grouped)
# import library required
library(dplyr)
library(psych)
require(foreign)
library(ggplot2)
require(MASS)
require(Hmisc)
require(reshape2)
library(GGally)
####################################
###Data Observation and Cleansing###
####################################
# The first observation
load("pokemon.Rdata")
head(pok,1)
# primary observe of data
summary(pok)
# checking unreasonable items in age
pok_age_s0 <- pok[pok$age <0,]
pok_age_s0
pok_age_l100 <- pok[pok$age >100,]
pok_age_l100
#@ This dataset is really good, without error or missing value
# However, according to the article, the records where the answer of
# ATTENTION_filter1 is not "Disagree" should be filtered
pok_new <- pok[pok$ATTENTION_filter1=="Disagree",]
pok_new$ATTENTION_filter1 <- NULL
summary(pok_new)
#################################
###Preparation of Grouped data###
#################################
###convert variables into numeric values###
pok_new[,4:30] <- pok_new[,4:30] %>% mutate_if(is.factor,as.numeric)
summary(pok_new)
###Justify the grouping###
# Calculate Cronbach's Alpha
# Attitude
alpha(pok_new[7:12], check.keys=TRUE)
# steps Attitude
alpha(pok_new[13:18], check.keys=TRUE)
# Behaviour
alpha(pok_new[19:24], check.keys=TRUE)
# Pokemon Behviour
alpha(pok_new[27:29], check.keys=TRUE)
#@ Since alpha of behaviour and Pokemon behaviour are "Acceptable"
#@ we group them together
# variable grouping
Attitude <- rowMeans(pok_new[7:12])
StepAttitude <- rowMeans(pok_new[13:18])
Behqviour <- rowMeans(pok_new[19:24])
PokemonBehaviour <- rowMeans(pok_new[27:29])
# create new dataset
Pok_Grouped <- pok_new[c(4:6)]
Pok_Grouped$Attitude <- Attitude
Pok_Grouped$StepsAttitude <- StepAttitude
Pok_Grouped$PhyscialActivity <- Behaviour
Pok_Grouped$PokemonGo_AppUsage <- pok_new$app_usage_PokemonGoApp_pokemonusage1
Pok_Grouped$social_sharing <- pok_new$social_sharing
Pok_Grouped$PokemonRelate_Behaviour <- PokemonBehaviour
head(Pok_Grouped)
summary(Pok_Grouped)
ggpairs(Pok_Grouped)
boxplot(PhyscialActivity~education,
data=Pok_Grouped,
main="Different boxplots for gender",
xlab="Month Number",
ylab="Amount of Physical Activity"
)
boxplot(PhyscialActivity~Gender,
data=Pok_Grouped,
main="Different boxplots for Education Level",
xlab="Education Level",
ylab="Amount of Physical Activity"
)
ggpairs(Pok_Grouped)
summary(Pok_Linear_final)
# import library required
library(dplyr)
library(psych)
require(foreign)
library(ggplot2)
require(MASS)
require(Hmisc)
require(reshape2)
library(GGally)
####################################
###Data Observation and Cleansing###
####################################
# The first observation
load("pokemon.Rdata")
head(pok,1)
# primary observe of data
summary(pok)
# checking unreasonable items in age
pok_age_s0 <- pok[pok$age <0,]
pok_age_s0
pok_age_l100 <- pok[pok$age >100,]
pok_age_l100
#@ This dataset is really good, without error or missing value
# However, according to the article, the records where the answer of
# ATTENTION_filter1 is not "Disagree" should be filtered
pok_new <- pok[pok$ATTENTION_filter1=="Disagree",]
pok_new$ATTENTION_filter1 <- NULL
summary(pok_new)
#################################
###Preparation of Grouped data###
#################################
###convert variables into numeric values###
pok_new[,4:30] <- pok_new[,4:30] %>% mutate_if(is.factor,as.numeric)
summary(pok_new)
###Justify the grouping###
# Calculate Cronbach's Alpha
# Attitude
alpha(pok_new[7:12], check.keys=TRUE)
# steps Attitude
alpha(pok_new[13:18], check.keys=TRUE)
# Behaviour
alpha(pok_new[19:24], check.keys=TRUE)
# Pokemon Behviour
alpha(pok_new[27:29], check.keys=TRUE)
#@ Since alpha of behaviour and Pokemon behaviour are "Acceptable"
#@ we group them together
# variable grouping
Attitude <- rowMeans(pok_new[7:12])
StepAttitude <- rowMeans(pok_new[13:18])
Behqviour <- rowMeans(pok_new[19:24])
PokemonBehaviour <- rowMeans(pok_new[27:29])
# create new dataset
Pok_Grouped <- pok_new[c(4:6)]
Pok_Grouped$Attitude <- Attitude
Pok_Grouped$StepsAttitude <- StepAttitude
Pok_Grouped$PhyscialActivity <- Behaviour
Pok_Grouped$PokemonGo_AppUsage <- pok_new$app_usage_PokemonGoApp_pokemonusage1
Pok_Grouped$social_sharing <- pok_new$social_sharing
Pok_Grouped$PokemonRelate_Behaviour <- PokemonBehaviour
head(Pok_Grouped)
summary(Pok_Grouped)
par(mfrow = c(2, 2))
plot(Pok_Linear_final)
Pok.Grouped_New <- Pok_Grouped
dev.off()
par(mfrow = c(2, 2))
plot(Pok_Linear)
dev.off()
par(mfrow = c(2, 2))
plot(Pok_Linear_final)
plot(Pok_Linear)
plot(Pok_Linear)
plot(Pok_Linear_final)
ggpairs(Pok.Grouped_New)
boxplot(PhyscialActivity~Pok_Grouped$education,
data=Pok_Grouped,
main="Different boxplots for gender",
xlab="Month Number",
ylab="Amount of Physical Activity"
)
dev.off()
boxplot(PhyscialActivity~education,
data=Pok.Grouped_New,
main="Different boxplots for gender",
xlab="Month Number",
ylab="Amount of Physical Activity"
)
Pok.Grouped_New <- Pok_Grouped
Pok.Grouped_New$Attitude <- NULL
Pok.Grouped_New$social_sharing <- NULL
boxplot(Pok.Grouped_New[,1]~education,
data=Pok.Grouped_New,
main="Different boxplots for gender",
xlab="Month Number",
ylab="Amount of Physical Activity"
)
par(mfrow = c(3, 3))
for(i in 1:7){
boxplot(Pok.Grouped_New[,i]~education, data=Pok.Grouped_New)
}
dev.off()
par(mfrow = c(3, 3))
for(i in 1:7){
boxplot(Pok.Grouped_New[,i]~Gender, data=Pok.Grouped_New)
}
par(mfrow = c(3, 2))
for(i in 1:7){
if(i != 2)
boxplot(Pok.Grouped_New[,i]~education, data=Pok.Grouped_New)
}
par(mfrow = c(2, 3))
for(i in 1:7){
if(i != 2)
boxplot(Pok.Grouped_New[,i]~education, data=Pok.Grouped_New)
}
dev.off()
par(mfrow = c(2, 3))
for(i in 1:7){
if(i != 3)
boxplot(Pok.Grouped_New[,i]~Gender, data=Pok.Grouped_New)
}
par(mfrow = c(2, 3))
for(i in 1:7){
if(i != 2)
boxplot(Pok.Grouped_New[,i]~education, data=Pok.Grouped_New)
}
for(i in 1:7){
if(i != 3)
boxplot(Pok.Grouped_New[,i]~Gender, data=Pok.Grouped_New)
}
ols_step_best_subset(Pok_Linear)
library(olsrr)
# import library required
library(dplyr)
library(psych)
library(ggplot2)
library(MASS)
library(olsrr)
# The first observation
load("pokemon.Rdata")
head(pok,1)
# primary observe of data
summary(pok)
# checking unreasonable items in age
pok_age_s0 <- pok[pok$age <0,]
pok_age_s0
pok_age_l100 <- pok[pok$age >100,]
pok_age_l100
# However, according to the article, the records where the answer of
# ATTENTION_filter1 is not "Disagree" should be filtered
pok_new <- pok[pok$ATTENTION_filter1=="Disagree",]
pok_new$ATTENTION_filter1 <- NULL
summary(pok_new)
###convert variables into numeric values###
pok_new[,4:30] <- pok_new[,4:30] %>% mutate_if(is.factor,as.numeric)
summary(pok_new)
# Calculate Cronbach's Alpha
# Attitude
alpha(pok_new[7:12], check.keys=TRUE)
# steps Attitude
alpha(pok_new[13:18], check.keys=TRUE)
# Behaviour
alpha(pok_new[19:24], check.keys=TRUE)
# Pokemon Behviour
alpha(pok_new[27:29], check.keys=TRUE)
# variable grouping
Attitude <- rowMeans(pok_new[7:12])
StepAttitude <- rowMeans(pok_new[13:18])
Behqviour <- rowMeans(pok_new[19:24])
PokemonBehaviour <- rowMeans(pok_new[27:29])
# create new dataset
Pok_Grouped <- pok_new[c(4:6)]
Pok_Grouped$Attitude <- Attitude
Pok_Grouped$StepsAttitude <- StepAttitude
Pok_Grouped$PhyscialActivity <- Behaviour
Pok_Grouped$PokemonGo_AppUsage <- pok_new$app_usage_PokemonGoApp_pokemonusage1
Pok_Grouped$social_sharing <- pok_new$social_sharing
Pok_Grouped$PokemonRelate_Behaviour <- PokemonBehaviour
head(Pok_Grouped)
summary(Pok_Grouped)
ggpairs(Pok_Grouped)
boxplot(PhyscialActivity~education,
data=Pok_Grouped,
main="Different boxplots for gender",
xlab="Month Number",
ylab="Amount of Physical Activity"
)
boxplot(PhyscialActivity~Gender,
data=Pok_Grouped,
main="Different boxplots for Education Level",
xlab="Education Level",
ylab="Amount of Physical Activity"
)
ggpairs(Pok_Grouped)
library(Hmisc)
ggpairs(Pok_Grouped)
library(GGally)
ggpairs(Pok_Grouped)
